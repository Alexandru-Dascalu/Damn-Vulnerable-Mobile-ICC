<?xml version="1.0" encoding="utf-8"?>
<resources xmlns:tools="http://schemas.android.com/tools" tools:ignore="TypographyEllipsis">
    <string name="broadcastTheftDOSExplanation">
        When a broadcast is sent, the sender does not receive any indication of what components have
        received that broadcast, and receivers can read all the data inside the broadcast intent.

        \n\nThe use of ordered implicit broadcasts can not only enable eavesdropping, but denial of
        service and man in the middle attacks as well.

        \n\nOrdered broadcasts are sent to receivers one at a time. A malicious app could register a
        broadcast receiver with a very high priority to
        ensure it is the first to receive it. It could extract the data from the broadcast, and
        then abort the broadcast, ensuring the intended receivers do not get it and thus perform a
        Denial of Service attack.

        \n\nWhen making a broadcast, the developer can specify the permission that a broadcast
        receiver needs to have to receive the intent. This can be used to guard against
        Broadcast Theft. But the malware could still get the permission. Even if the permission is a
        Signature one, the attacker could get it if they have stolen the developer\'s certificate.
        Other ways for a developer to guard against these attacks is to not put sensitive
        information in a broadcast unless necessary, to use explicit broadcasts for intra-app
        use, or to send broadcast using LocalBroadcastManager. Alternatively, they could not rely on
        public broadcast and use one of the newer Android APIs to achieve their goal.
    </string>

    <string name="broadcastTheftDOSInstructions">
        Go to the Call Redirect app and look around. Type in a country code to be added to phone
        numbers you dial.

        \n\nThen go to the CPU Booster and play around with it. Grant the storage permission it asks\
        for. Go to the Advanced Functionality activity and grant the app the permission it asks for.

        \n\nFollowing that, dial a phone number. This number must not include a country code at the
        beginning! You might then see the call being cancelled automatically, or not, depending on
        the security level.

        \n\nIf the malware intercepts the broadcast, it will place a flag in its log.
    </string>

    <string name="broadcastTheftDOSScenarioExplanation">

    </string>

    <string name="broadcastTheftDOSAPIRequirements">

    </string>

    <!--security level descriptions-->
    <string name="broadcastTheftDOSLowDescription">
        The app listens for public broadcasts sent by the system. Since this app re-writes phone
        numbers before they are called, it should have a positive low priority, as the
        <a href="https://developer.android.com/reference/android/content/Intent.html#ACTION_NEW_OUTGOING_CALL">documentation</a>
        for the ACTION_NEW_OUTGOING_CALL intent action says.
        This is because it should retain any changes made by other receivers.

        \n\nHowever, any other app can listen to this broadcast if it has the
        PROCESS_OUTGOING_CALLS permission. And other receivers can register with a very high
        priority, and thus cancel the broadcast before legitimate receivers can even see it.
    </string>
    <string name="broadcastTheftDOSHighDescription">
        Since the broadcast is sent by the system and not by us, we can not protect it with a
        permission. One way to increase security is to set the priority level of the broadcast
        receiver to the maximum possible value, just like the malware does. This way, the receiver of this app will hopefully
        be called before the malware\'s receiver. The vulnerable app can then change the number in
        the broadcast, and then cancel it. The number will still be called because when the
        broadcast was sent, a final receiver was specified, which gets the broadcast even if
        another receiver in the chain cancels it.

        \n\nAccording to the
        <a href="https://developer.android.com/reference/android/content/Intent.html#ACTION_NEW_OUTGOING_CALL">Android documentation</a>,
        receivers with the same priority are executed in a random order. From our experience, on devices
        on Android 7.1 or 8 (API 25 or 26, respectively), we have seen that the receiver of the
        vulnerable app gets called first. This is not guaranteed to be true on other devices.

        \n\nTherefore, you might not be able to see the flag for the high activity level, depending
        on your device, as the ordered broadcast will be cancelled before it gets to the malware\'s receiver.
    </string>
    <string name="broadcastTheftDOSImpossibleDescription">
        Relying on the broadcast receiver with a high priority being called before the receiver of
        the malware is not a reliable solution, as it depends on the perhaps random order the OS calls
        the receivers. Moreover, in the high security level, the broadcast was canceled and thus
        would not be received any other genuine receiver that needed to process the call.

        Therefore, the best solution to fix this vulnerability rests on the user uninstalling the malware.
        The CPU Booster app asks for a phone permissions, when this kind of app should not need this permission.
        This is a good indicator it is a malicious app.

        Uninstall the CPU Booster app to make the call redirection work properly.
    </string>

    <string name="callRedirectAppName">Call Redirect</string>
    <string name="cpuBoosterAppName">CPU Booster</string>

    <string-array name="broadcastTheftDOSFlags">
        <item>Do not go gentle into that good night!</item>
        <item>And death shall have no dominion</item>
    </string-array>

    <string name="callRedirectLowManifest">
        <![CDATA[
            <manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"
                \n\tpackage=\"uk.ac.swansea.dascalu.dvmicc.call_redirect\">

                \n\n\t<uses-permission android:name=
                    \n\t\t\"android.permission.PROCESS_OUTGOING_CALLS\"/>
                \n\t<uses-permission android:name=
                    \n\t\t\"android.permission.READ_EXTERNAL_STORAGE\"/>

                \n\n\t<application
                    \n\t\tandroid:allowBackup=\"true\"
                    \n\t\tandroid:icon=\"@mipmap/ic_launcher\"
                    \n\t\tandroid:label=\"@string/app_name\"
                    \n\t\tandroid:roundIcon=\"@mipmap/ic_launcher_round\"
                    \n\t\tandroid:supportsRtl=\"true\"
                    \n\t\tandroid:theme=\"@style/Theme.DamnVulnerableMobileICC\">

                    \n\n\t\t<activity android:name=\".MainActivity\">
                        \n\t\t\t<intent-filter>
                            \n\t\t\t\t<action android:name=
                                \n\t\t\t\t\t\"android.intent.action.MAIN\" />
                            \n\t\t\t\t<category android:name=
                                \n\t\t\t\t\t\"android.intent.category.LAUNCHER\" />
                        \n\t\t\t</intent-filter>
                    \n\t\t</activity>

                    \n\n\t\t<receiver android:name=\".icc.CallRedirectionReceiver\"
                        \n\t\t\tandroid:enabled=\"true\">

                        \n\n\t\t\t<intent-filter android:priority=\"10\">
                            \n\t\t\t\t<action android:name=
                                \n\t\t\t\t\t\"android.intent.action.NEW_OUTGOING_CALL\"/>
                        \n\t\t\t</intent-filter>
                    \n\n\t\t</receiver>
                \n\n\t</application>
            \n</manifest>]]>
    </string>
    <string name="callRedirectHighManifest">
        <![CDATA[
            <manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"
                \n\tpackage=\"uk.ac.swansea.dascalu.dvmicc.call_redirect\">

                \n\n\t<uses-permission android:name=
                    \n\t\t\"android.permission.PROCESS_OUTGOING_CALLS\"/>
                \n\t<uses-permission android:name=
                    \n\t\t\"android.permission.READ_EXTERNAL_STORAGE\"/>

                \n\n\t<application
                    \n\t\tandroid:allowBackup=\"true\"
                    \n\t\tandroid:icon=\"@mipmap/ic_launcher\"
                    \n\t\tandroid:label=\"@string/app_name\"
                    \n\t\tandroid:roundIcon=\"@mipmap/ic_launcher_round\"
                    \n\t\tandroid:supportsRtl=\"true\"
                    \n\t\tandroid:theme=\"@style/Theme.DamnVulnerableMobileICC\">

                    \n\n\t\t<activity android:name=\".MainActivity\">
                        \n\t\t\t<intent-filter>
                            \n\t\t\t\t<action android:name=
                                \n\t\t\t\t\t\"android.intent.action.MAIN\" />
                            \n\t\t\t\t<category android:name=
                                \n\t\t\t\t\t\"android.intent.category.LAUNCHER\" />
                        \n\t\t\t</intent-filter>
                    \n\t\t</activity>

                    \n\n\t\t<receiver android:name=\".icc.CallRedirectionReceiver\"
                        \n\t\t\tandroid:enabled=\"true\">

                        \n\n\t\t\t<intent-filter android:priority=\"2147483647\">
                            \n\t\t\t\t<action android:name=
                                \n\t\t\t\t\t\"android.intent.action.NEW_OUTGOING_CALL\"/>
                        \n\t\t\t</intent-filter>
                    \n\n\t\t</receiver>
                \n\n\t</application>
            \n</manifest>]]>
    </string>

    <string name="callRedirectLowIntentCode">
        <![CDATA[
            class CallRedirectionReceiver() {
                \n\toverride fun onReceive(context: Context?, intent: Intent?) {

                    \n\n\t\t//check intent action is the one the receiver listens for
                    \n\t\tif(intent!!.action ==
                        \n\t\t\t\"android.intent.action.NEW_OUTGOING_CALL\") {
                        \n\t\t\tvar phoneNumber : String? = resultData

                        \n\n\t\t\t//check if number does not already have country code
                        \n\t\t\tif(phoneNumber!![0] != \'+\') {
                            \n\t\t\t\tresultData = addCountryCode(phoneNumber,
                                \n\t\t\t\t\tgetCountryCode(context))
                        \n\t\t\t}
                    \n\t\t}
                \n\t}
                \n\t...
            \n}]]>
    </string>
    <string name="callRedirectHighIntentCode">
        <![CDATA[
            class CallRedirectionReceiver() {
                \n\toverride fun onReceive(context: Context?, intent: Intent?) {

                    \n\n\t\t//check intent action is the one the receiver listens for
                    \n\t\tif(intent!!.action ==
                        \n\t\t\t\"android.intent.action.NEW_OUTGOING_CALL\") {
                        \n\t\t\tvar phoneNumber : String? = resultData

                        \n\n\t\t\t//check if number does not already have country code
                        \n\t\t\tif(phoneNumber!![0] != \'+\') {
                            \n\t\t\t\tresultData = addCountryCode(phoneNumber,
                                \n\t\t\t\t\tgetCountryCode(context))
                                \n\t\t\t\tabortBroadcast()
                        \n\t\t\t}
                    \n\t\t}
                \n\t}
                \n\t...
            \n}]]>
    </string>

    <string name="cpuBoosterManifest">
        <![CDATA[
            <manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"
                \n\tpackage=\"uk.ac.swansea.dascalu.dvmicc.cpu_booster\">

                \n\n\t<uses-permission android:name=
                    \n\t\t\"android.permission.KILL_BACKGROUND_PROCESSES\" />
                \n\t<uses-permission android:name=
                    \n\t\t\"android.permission.REORDER_TASKS\"/>
                \n\t<uses-permission android:name=
                    \n\t\t\"android.permission.SYSTEM_ALERT_WINDOW\"/>
                \n\t<uses-permission android:name=
                    \n\t\t\"android.permission.PROCESS_OUTGOING_CALLS\"/>
                \n\t<uses-permission android:name=
                    \n\t\t\"android.permission.WRITE_SETTINGS\" />
                \n\t<uses-permission android:name=
                    \n\t\t\"android.permission.PACKAGE_USAGE_STATS\" />
                \n\t<uses-permission android:name=
                    \n\t\t\"android.permission.PROCESS_OUTGOING_CALLS\"/>

                \n\n\t<application
                    \n\t\tandroid:allowBackup=\"true\"
                    \n\t\tandroid:icon=\"@mipmap/ic_launcher\"
                    \n\t\tandroid:label=\"@string/app_name\"
                    \n\t\tandroid:roundIcon=\"@mipmap/ic_launcher_round\"
                    \n\t\tandroid:supportsRtl=\"true\"
                    \n\t\tandroid:theme=\"@style/Theme.DamnVulnerableMobileICC\">

                    \n\n\t\t<activity android:name=\".MainActivity\">
                        \n\t\t\t<intent-filter>
                            \n\t\t\t\t<action android:name=\"android.intent.action.MAIN\" />

                            \n\t\t\t\t<category android:name=\"android.intent.category.LAUNCHER\" />
                        \n\t\t\t</intent-filter>
                    \n\t\t</activity>
                    \n\t\t<activity android:name=\".AdvancedActivity\"/>
                    \n\t\t<activity android:name=\".LogActivity\"/>

                    \n\n\t\t<receiver android:name=\".icc.AppActivityReceiver\">
                        \n\t\t\t<intent-filter android:priority=\"2147483647\">
                            \n\t\t\t\t<action android:name=
                                \n\t\t\t\t\t\"android.intent.action.NEW_OUTGOING_CALL\"/>
                        \n\t\t\t</intent-filter>
                    \n\t\t</receiver>

                \n\n\t</application>
            \n</manifest>]]>
    </string>
    <string name="cpuBoosterMainActivityIntentCode">
        <![CDATA[
            class MainActivity : AppCompatActivity() {
                \n\t...
                \n\toverride fun onOptionsItemSelected(item: MenuItem): Boolean {
                    \n\t\twhen(item.itemId) {
                        \n\t\t\tR.id.log_button -> {
                            \n\t\t\t\tval intent = Intent(this, LogActivity::class.java)
                            \n\t\t\t\tstartActivity(intent)
                            \n\t\t\t\treturn true
                        \n\t\t\t}
                        \n\t\t\t...
                        \n\t\t\telse -> return super.onOptionsItemSelected(item)
                    \n\t\t}
                \n\t}
                \n\t...
                \n\tfun startAdvancedActivity(view: View) {
                    \n\t\tval intent = Intent(this, AdvancedActivity::class.java)
                    \n\t\tstartActivity(intent)
                \n\t}
            \n}]]>
    </string>
    <string name="cpuBoosterAdvancedActivityIntentCode">
        <![CDATA[
            class AdvancedActivity :  AppCompatActivity() {
                \n\t...
                \n\tfun openWriteSettings(view: View) {
                    \n\t\tif (Build.VERSION.SDK_INT >= Build.VERSION_CODES.M) {
                        \n\t\t\tval intent = Intent(Settings.ACTION_MANAGE_WRITE_SETTINGS)
                        \n\t\t\tstartActivity(intent)
                    \n\t\t} else {
                        \n\t\t\tSnackbar.make(view, \"Only supported on Android 6 and up!\",
                            \n\t\t\t\tSnackbar.LENGTH_LONG).show()
                    \n\t\t}
                \n\t}

                \n\n\tfun openOverlaySettings(view: View) {
                    \n\t\tif(Build.VERSION.SDK_INT >= Build.VERSION_CODES.M) {
                        \n\t\t\tval intent = Intent(Settings.ACTION_MANAGE_OVERLAY_PERMISSION,
                            \n\t\t\t\tUri.parse("package:$packageName"))
                        \n\t\t\tstartActivityForResult(intent, 0)
                    \n\t\t} else {
                        \n\t\t\tSnackbar.make(view, \"Only supported on Android 6 and up!\",
                            \n\t\t\t\tSnackbar.LENGTH_LONG).show()
                    \n\t\t}
                \n\t}

                \n\n\tfun openUsageAccessSettings(view: View) {
                    \n\t\tif(Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) {
                        \n\t\t\tval intent = Intent(Settings.ACTION_USAGE_ACCESS_SETTINGS)
                        \n\t\t\tstartActivity(intent)
                    \n\t\t} else {
                        \n\t\t\tSnackbar.make(view, \"Only supported on Android 6 and up!\",
                            \n\t\t\t\tSnackbar.LENGTH_LONG).show()
                    \n\t\t}
                \n\t}
            \n}]]>
    </string>
</resources>